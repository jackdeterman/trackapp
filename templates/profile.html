{% extends 'layout.html' %}

{% block body %}

<h2 class="mt-3">{{ user.get_full_name }}</h2><br/>

<div class="float-right mb-3">
    <a href="{% url 'add_result' user.id %}" class="btn btn-primary btn-sm">Add Result</a>
    <a href="{% url 'edit_profile' user.id %}" class="btn btn-primary btn-sm">Edit Profile</a>
    <a href="{% url 'merge_athlete' user.id %}" class="btn btn-primary btn-sm">Merge Athlete</a>
</div>

{% for event, event_results in results_by_event.items %}

<canvas id="chart-{{event.id}}" width="100" height="20"></canvas>
<script>
var ctx = document.getElementById('chart-{{event.id}}').getContext('2d');
var myChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: [{% for result in event_results %}'{{ result.meet.description }}',{% endfor %}],
        datasets: [{
            label: 'Result',
            data: [{% for result in event_results %}'{{ result.result }}',{% endfor %}],
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            y: {
                beginAtZero: false
            }
        }
    }
});
</script>

    <h4>{{ event.name }}</h4>
    <table class="table table-striped">
        <th>Meet</th>
        <th>Meet Date</th>
        <th>Result</th>
        <th>Method</th>
        <th>Edit Result</th>
        <th>Delete</th>
    
        {% for result in event_results %}
            <tr {% if result.is_pr %}class="table-success"{% endif %}>
                <td>
                    <a href="{% url 'meet' result.meet.id %}"> {{result.meet.description}}</a>
                </td>
                <td>{{ result.meet.date }}</td>
                <td>
                    {{result.formatted_result}}
                </td>
                <td>{{ result.method }}</td>
                <td>
                    <a href="{% url 'edit_result' result.id %}" class="btn btn-primary btn-sm">Edit Result</a>
                </td>
                <td>
                    <a href="{% url 'delete_result' result.id %}" class="btn btn-primary btn-sm">Delete</a>
                </td>
            </tr>
        {% endfor %}
    </table>
{% endfor %}


{% endblock %}

